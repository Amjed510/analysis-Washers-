# 📱 التحليل العملي لتجربة المستخدم (UX/UI) - نظام WashPOS

> [!IMPORTANT]
> **التركيز:** POS-Like Flow - تدفق سريع عند نقطة البيع  
> **الهدف:** إتمام عملية بيع كاملة في 20-30 ثانية  
> **المتطلب:** الباك-إند و الـAPI جاهزين (منتجات، فواتير، سندات)

---

## ⏱️ مؤشرات الأداء الرئيسية (KPIs)

| المؤشر | الهدف | الحد الأقصى |
|--------|-------|-------------|
| وقت إتمام عملية البيع | 20 ثانية | 30 ثانية |
| عدد النقرات للوصول للدفع | 3 نقرات | 4 نقرات |
| وقت الاستجابة للمس | < 100ms | 200ms |
| وقت الطباعة | < 3 ثواني | 5 ثواني |

---

## 1️⃣ تدفق المستخدم الأساسي (User Flow)

```
┌─────────────────────────────────────────────────────────────┐
│                     POS User Flow                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌───────────────┐                                         │
│   │ تسجيل الدخول  │ ◄── مرة واحدة في بداية الوردية         │
│   └───────────────┘                                         │
│          │                                                   │
│          ▼                                                   │
│   ┌───────────────┐                                         │
│   │ اختيار الخدمة │ ◄── شاشة رئيسية بأزرار كبيرة           │
│   └───────────────┘                                         │
│          │                                                   │
│          ▼                                                   │
│   ┌───────────────┐                                         │
│   │ اختيار الحجم  │ ◄── Bottom Sheet (صغيرة/متوسطة/كبيرة)  │
│   └───────────────┘                                         │
│          │                                                   │
│          ▼                                                   │
│   ┌───────────────┐                                         │
│   │  شاشة الدفع   │ ◄── عرض السعر + طريقة الدفع            │
│   └───────────────┘                                         │
│          │                                                   │
│      ┌───┴───┐                                              │
│      ▼       ▼                                              │
│   💵 نقد   💳 شبكة                                          │
│      │       │                                              │
│      └───┬───┘                                              │
│          ▼                                                   │
│   ┌───────────────┐                                         │
│   │ إنشاء فاتورة  │ ◄── + سند قبض تلقائي                   │
│   └───────────────┘                                         │
│          │                                                   │
│          ▼                                                   │
│   ┌───────────────┐                                         │
│   │    طباعة     │ ◄── تلقائية بدون سؤال                   │
│   └───────────────┘                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 2️⃣ شاشة اختيار الخدمة (Service Selection)

### 2.1 المواصفات

| العنصر | المواصفات |
|--------|----------|
| **نوع العرض** | Grid من البطاقات (Cards) |
| **حجم البطاقة** | كبير - يناسب اللمس باليد الواحدة |
| **الأيقونات** | واضحة وكبيرة لكل خدمة |
| **السعر** | لا يظهر هنا (يظهر لاحقاً حسب الحجم) |

### 2.2 قائمة الخدمات الأساسية

```
┌─────────────────────────────────────────────────────────────┐
│                     اختيار الخدمة                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│   │     🚗      │  │    🚗✨     │  │     💨      │        │
│   │   غسيل     │  │   غسيل     │  │   غسيل     │        │
│   │   خارجي    │  │   تركواز   │  │   بخار     │        │
│   └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│   │     ⚡      │  │     🧴      │  │     ✨      │        │
│   │   غسيل     │  │   غسيل     │  │   تلميع    │        │
│   │   اكسبرس   │  │   بخار+جلد │  │   خارجي    │        │
│   └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│   │     📦      │  │     💧      │  │     🎫      │        │
│   │   إضافات   │  │    ماء     │  │   كوبونات  │        │
│   │   أخرى     │  │            │  │            │        │
│   └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 2.3 ملاحظات UX الهامة

> [!TIP]
> **الممارسات المطبقة:**
> - ❌ لا قوائم منسدلة (Dropdowns)
> - ❌ لا كتابة يدوية
> - ✅ لمسة واحدة للاختيار
> - ✅ أزرار كبيرة بعرض 30% من الشاشة على الأقل

---

## 3️⃣ اختيار حجم السيارة (Car Size Selection)

### 3.1 طريقة العرض المفضلة

| الخيار | الميزة | العيب |
|--------|--------|-------|
| **Bottom Sheet ✅** | أسرع، لا تفقد السياق | - |
| شاشة كاملة | مساحة أكبر | أبطأ، نقرة إضافية |

### 3.2 تصميم Bottom Sheet

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│                   اختر حجم السيارة                          │
│                                                             │
│   ┌──────────────────────────────────────────────────────┐ │
│   │  🚗  صغيرة (سيدان)                                   │ │
│   └──────────────────────────────────────────────────────┘ │
│                                                             │
│   ┌──────────────────────────────────────────────────────┐ │
│   │  🚙  متوسطة (SUV / كروس)                             │ │
│   └──────────────────────────────────────────────────────┘ │
│                                                             │
│   ┌──────────────────────────────────────────────────────┐ │
│   │  🚐  كبيرة (فان / بيك أب)                            │ │
│   └──────────────────────────────────────────────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 ملاحظات UX

> [!IMPORTANT]
> **السلوك المطلوب:**
> - كل خيار = زر كبير بعرض الشاشة الكامل
> - عند الضغط ينتقل **مباشرة** لشاشة الدفع
> - لا حاجة لزر "التالي" أو "متابعة"

---

## 4️⃣ شاشة الدفع (Payment Screen) - أهم شاشة ⭐

### 4.1 المحتوى المطلوب

| العنصر | الوصف |
|--------|-------|
| اسم الخدمة | مثال: "غسيل تركواز" |
| حجم السيارة | مثال: "متوسطة" |
| **السعر النهائي** | بارز وكبير (مثل: 70.00 ر.س) |
| طريقة الدفع | أزرار نقد/شبكة |

### 4.2 تصميم الشاشة

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│   ┌───────────────────────────────────────────────────────┐ │
│   │                    ملخص الطلب                         │ │
│   │                                                       │ │
│   │   الخدمة:    غسيل تركواز 🚗✨                         │ │
│   │   الحجم:     متوسطة 🚙                                │ │
│   │                                                       │ │
│   │   ─────────────────────────────────────               │ │
│   │                                                       │ │
│   │         ┌─────────────────────────┐                   │ │
│   │         │                         │                   │ │
│   │         │    💰 70.00 ر.س         │                   │ │
│   │         │                         │                   │ │
│   │         └─────────────────────────┘                   │ │
│   │                                                       │ │
│   └───────────────────────────────────────────────────────┘ │
│                                                             │
│                    طريقة الدفع                              │
│                                                             │
│   ┌─────────────────────┐    ┌─────────────────────┐       │
│   │                     │    │                     │       │
│   │   💵 نقدًا          │    │   💳 شبكة           │       │
│   │                     │    │                     │       │
│   └─────────────────────┘    └─────────────────────┘       │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │                                                     │  │
│   │                 ✅ إتمام الدفع                       │  │
│   │                                                     │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 4.3 ملاحظات UX الحرجة

> [!CAUTION]
> **قواعد أمان:**
> - زر الدفع يكون **بارز بلون مختلف** (أخضر مثلاً)
> - **منع الرجوع للخلف** بعد بدء عملية الدفع
> - **تأكيد بصري قوي** عند نجاح العملية (صوت + لون أخضر)
> - **منع الضغط المتكرر** على زر الدفع (debounce)

---

## 5️⃣ حالات الدفع (Payment States)

### 5.1 الدفع النقدي (Cash)

```
┌─────────────────────────────────────────────────────────────┐
│                     💵 الدفع النقدي                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   الإجراء:                                                  │
│   ═════════════                                             │
│   1. المستخدم يضغط "💵 نقدًا"                               │
│   2. زر واحد فقط: "تم استلام المبلغ"                        │
│   3. رسالة نجاح فورية ✅                                    │
│   4. طباعة تلقائية (بدون سؤال)                             │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │         ✅ تم استلام المبلغ نقدًا                    │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│   ⏱️ الوقت المتوقع: 2-3 ثواني                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 الدفع بالشبكة (Card/Mada)

```
┌─────────────────────────────────────────────────────────────┐
│                     💳 الدفع بالشبكة                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   الإجراء:                                                  │
│   ═════════════                                             │
│   1. المستخدم يضغط "💳 شبكة"                                │
│   2. عرض مؤشر انتظار واضح (Spinner كبير)                   │
│   3. **منع أي تفاعل** حتى الحصول على النتيجة               │
│   4. عند النجاح: رسالة + طباعة تلقائية                     │
│   5. عند الفشل: رسالة واضحة + خيار إعادة المحاولة          │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │                                                     │  │
│   │              ◐ ◑ ◒ ◓                               │  │
│   │         جاري معالجة الدفع...                       │  │
│   │                                                     │  │
│   │         ⚠️ لا تغلق التطبيق                         │  │
│   │                                                     │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│   ⏱️ الوقت المتوقع: 5-15 ثانية                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 6️⃣ الطباعة (Printing)

### 6.1 المواصفات

| المتطلب | القيمة |
|---------|--------|
| نوع الطابعة | Thermal Printer (SUNMI) |
| الاعتماد على الإنترنت | ❌ لا |
| سؤال المستخدم | ❌ لا - تلقائية |
| إعادة المحاولة | ✅ نعم - عند الفشل |

### 6.2 سلوك الطباعة

```
┌─────────────────────────────────────────────────────────────┐
│                     🖨️ منطق الطباعة                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────────┐                                          │
│   │ دفع ناجح   │                                          │
│   └─────────────┘                                          │
│          │                                                  │
│          ▼                                                  │
│   ┌─────────────────────┐                                  │
│   │ طباعة تلقائية      │                                  │
│   │ (بدون نافذة تأكيد)  │                                  │
│   └─────────────────────┘                                  │
│          │                                                  │
│      ┌───┴───┐                                             │
│      ▼       ▼                                             │
│   ✅ نجاح   ❌ فشل                                          │
│      │       │                                             │
│      │       ▼                                             │
│      │   ┌───────────────┐                                 │
│      │   │ إعادة الطباعة │                                 │
│      │   │ (تلقائي 3x)   │                                 │
│      │   └───────────────┘                                 │
│      │                                                      │
│      ▼                                                      │
│   ┌─────────────────────────┐                              │
│   │ رسالة صغيرة (Toast):   │                              │
│   │ "تمت الطباعة بنجاح ✅" │                              │
│   └─────────────────────────┘                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 7️⃣ حالات الخطأ (Error Handling UX)

### 7.1 مصفوفة التعامل مع الأخطاء

| الحالة | الرسالة | الإجراء | المسؤول |
|--------|---------|---------|---------|
| **فشل الشبكة** | "لا يوجد اتصال" | حفظ العملية محليًا ➔ مزامنة لاحقاً | النظام |
| **فشل جهاز الدفع** | "فشل الاتصال بالجهاز" | زر "إعادة المحاولة" | المستخدم |
| **انقطاع التطبيق** | - | استعادة العملية عند إعادة الفتح | النظام |
| **فشل الطباعة** | "فشل الطباعة" | إعادة تلقائية ➔ زر يدوي | النظام/المستخدم |
| **بطاقة مرفوضة** | "البطاقة مرفوضة" | "جرب نقد" أو "بطاقة أخرى" | المستخدم |

### 7.2 تصميم رسائل الخطأ

```
┌─────────────────────────────────────────────────────────────┐
│                     ❌ رسالة خطأ نموذجية                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │                                                     │  │
│   │              ⚠️ انقطع الاتصال                       │  │
│   │                                                     │  │
│   │         تم حفظ العملية وسيتم إرسالها               │  │
│   │              عند عودة الاتصال                       │  │
│   │                                                     │  │
│   │   ┌─────────────────┐ ┌─────────────────┐          │  │
│   │   │ 🔄 إعادة فوراً  │ │  ✅ متابعة     │          │  │
│   │   └─────────────────┘ └─────────────────┘          │  │
│   │                                                     │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 8️⃣ قائمة الخدمات والأسعار (من النظام الحالي)

### 8.1 خدمات الغسيل الأساسية

| الخدمة | صغير | وسط | كبير |
|--------|------|-----|------|
| غسيل خارجي | 30 ر.س | - | 35 ر.س |
| غسيل تركواز | 70 ر.س | 75 ر.س | 80 ر.س |
| غسيل تركواز بلس | 85 ر.س | 90 ر.س | 95 ر.س |

### 8.2 خدمات البخار

| الخدمة | صغير | وسط | كبير |
|--------|------|-----|------|
| غسيل ماكينة بخار | 35 ر.س | - | - |
| غسيل بخار قماش | 155 ر.س | - | 185 ر.س |
| غسيل بخار جلد | 115 ر.س | - | 135 ر.س |

### 8.3 خدمات اكسبرس

| الخدمة | صغير | وسط | كبير |
|--------|------|-----|------|
| غسيل اكسبرس | 45 ر.س | 50 ر.س | 55 ر.س |
| غسيل اكسبرس بدون كيس | 40 ر.س | - | - |

### 8.4 خدمات التلميع

| الخدمة | صغير | وسط | كبير |
|--------|------|-----|------|
| تلميع خارجي بواكس طبقة النانو | 99 ر.س | 107 ر.س | 114 ر.س |
| تلميع كفرات | 5 ر.س | - | - |

### 8.5 العروض الخاصة

| العرض | صغير | كبير |
|-------|------|------|
| عرض بخار قماش | 114 ر.س | 129 ر.س |
| عرض غسيل تركواز بلس | 55 ر.س | 60 ر.س |
| عرض بخار جلد | 99 ر.س | 114 ر.س |

### 8.6 خدمات أخرى

| الخدمة | السعر |
|--------|-------|
| كيس دعاسات | 5 ر.س |
| ماء | 10 ر.س |
| غسيل مجانا | 0 ر.س |
| خارجية | 25 ر.س |
| داخلية صغير | 15 ر.س |
| داخلية كبير | 20 ر.س |
| دفتر كوبونات | 600 ر.س |

---

## 9️⃣ توصيات التنفيذ

### 9.1 توصيات UX

| التوصية | الأهمية |
|---------|---------|
| **لا أكثر من 3 شاشات** للوصول للدفع | حرج |
| **لا إدخال يدوي** - كل شيء بالضغط | حرج |
| **أزرار كبيرة** - 48dp minimum | عالي |
| **ألوان واضحة** للحالات (نجاح/فشل) | عالي |
| **صوت تأكيد** عند النجاح | متوسط |

### 9.2 توصيات للمصمم

```
┌─────────────────────────────────────────────────────────────┐
│                   📐 Design Specifications                   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   Button Height:      56dp minimum (Touch Target)           │
│   Card Spacing:       16dp                                  │
│   Font Size (Price):  32sp (bold)                          │
│   Font Size (Labels): 16sp                                  │
│   Primary Color:      Green (#4CAF50) - للنجاح والدفع      │
│   Error Color:        Red (#F44336)                         │
│   Warning Color:      Orange (#FF9800)                      │
│   Background:         Gray (#F5F5F5)                        │
│                                                             │
│   Animation Duration: 200ms (transitions)                   │
│   Debounce Time:      500ms (prevent double tap)           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 🔟 Wireframes المقترحة

### 10.1 شاشة اختيار الخدمة (Wireframe)

```
┌────────────────────────────────────────┐
│ 🟢 متصل │ WashPOS     [≡]              │
├────────────────────────────────────────┤
│                                        │
│         اختر نوع الخدمة                │
│                                        │
│  ┌──────────┐  ┌──────────┐           │
│  │   🚗    │  │   🚗✨   │           │
│  │  خارجي  │  │ تركواز  │           │
│  └──────────┘  └──────────┘           │
│                                        │
│  ┌──────────┐  ┌──────────┐           │
│  │   💨    │  │   ⚡    │           │
│  │  بخار   │  │ اكسبرس  │           │
│  └──────────┘  └──────────┘           │
│                                        │
│  ┌──────────┐  ┌──────────┐           │
│  │   ✨    │  │   📦    │           │
│  │ تلميع   │  │ إضافات  │           │
│  └──────────┘  └──────────┘           │
│                                        │
└────────────────────────────────────────┘
```

### 10.2 شاشة الدفع (Wireframe)

```
┌────────────────────────────────────────┐
│ 🟢 متصل │ الدفع              [رجوع]   │
├────────────────────────────────────────┤
│                                        │
│  ┌────────────────────────────────┐   │
│  │  🚗✨ غسيل تركواز             │   │
│  │  🚙 سيارة متوسطة              │   │
│  │  ─────────────────────────    │   │
│  │                                │   │
│  │       💰 75.00 ر.س            │   │
│  │                                │   │
│  └────────────────────────────────┘   │
│                                        │
│        ───── طريقة الدفع ─────        │
│                                        │
│  ┌──────────────┐ ┌──────────────┐    │
│  │              │ │              │    │
│  │  💵 نقدًا   │ │  💳 شبكة    │    │
│  │              │ │              │    │
│  └──────────────┘ └──────────────┘    │
│                                        │
│  ┌────────────────────────────────┐   │
│  │                                │   │
│  │       ✅ إتمام العملية         │   │
│  │                                │   │
│  └────────────────────────────────┘   │
│                                        │
└────────────────────────────────────────┘
```

---

## 📋 Checklist للمطورين

### تحقق قبل الإطلاق

- [ ] وقت الوصول للدفع < 20 ثانية
- [ ] عدد النقرات ≤ 4
- [ ] الأزرار بحجم 48dp+
- [ ] منع الضغط المتكرر (Debounce)
- [ ] رسائل خطأ واضحة بالعربي
- [ ] الطباعة تلقائية
- [ ] حفظ محلي عند فقد الاتصال
- [ ] صوت عند النجاح
- [ ] اختبار على SUNMI V2s

---

## 📚 المراجع

- [Material Design Touch Targets](https://material.io/design/usability/accessibility.html)
- [POS UX Best Practices](https://www.nngroup.com/articles/touchscreen-kiosk-ux/)
- SUNMI V2s Developer Documentation

---

> [!NOTE]
> هذا التحليل مُعد للمصممين والمطورين ويركز على التطبيق العملي السريع.
> للتفاصيل التقنية الكاملة، راجع ملفات السيناريوهات.
